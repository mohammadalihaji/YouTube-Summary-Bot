<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YouTube Summary Bot ðŸ¤–</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #0f172a; }
    .container-shadow { box-shadow: 0 15px 40px rgba(0,0,0,0.7); }
    .spinner { border-top-color: #6366f1; animation: spin 1s ease-in-out infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .summarize-btn-enhanced { transition: all 0.3s; box-shadow: 0 10px 20px rgba(79,70,229,0.4); }
    .summarize-btn-enhanced:hover { box-shadow: 0 15px 30px rgba(99,102,241,0.6); }
    .summarize-btn-enhanced:active { transform: scale(0.98); box-shadow: 0 5px 10px rgba(79,70,229,0.4); }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

<div class="w-full max-w-2xl bg-gray-800 container-shadow rounded-2xl p-8 space-y-8 border border-gray-700/50">
  <header class="text-center space-y-2">
    <h1 class="text-5xl font-extrabold text-white">YouTube Summary Bot ðŸ¤–</h1>
    <p class="text-gray-400">Paste a YouTube link to get a <strong class="text-indigo-400">5-point summary</strong>.</p>
  </header>

  <div class="space-y-4">
    <input type="url" id="youtubeLink" placeholder="https://www.youtube.com/watch?v=..." 
      class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"
    />
    <button id="summarizeBtn" onclick="summarizeVideo()" class="w-full py-3 text-white font-bold rounded-xl summarize-btn-enhanced bg-indigo-600">
      Summarize Video
    </button>
  </div>

  <div id="statusArea" class="text-center min-h-12 flex items-center justify-center"></div>
  <div id="resultsArea" class="bg-gray-900/50 p-6 rounded-2xl border border-indigo-500 space-y-4 hidden">
    <h2 class="text-2xl font-bold text-indigo-400">5-Point Summary</h2>
    <div id="summaryContent" class="text-gray-300 leading-relaxed space-y-3"></div>
  </div>
</div>

<script>
function showStatus(msg,color='text-gray-400'){
  document.getElementById('statusArea').innerHTML=`<p class="${color} font-medium">${msg}</p>`;
  document.getElementById('resultsArea').classList.add('hidden');
}
function showLoading(){
  document.getElementById('summarizeBtn').disabled=true;
  document.getElementById('summarizeBtn').innerHTML=`<svg class="spinner h-5 w-5 mr-3 border-4 border-gray-300 border-solid rounded-full" viewBox="0 0 24 24"></svg>Analyzing Video...`;
  showStatus("Processing...","text-indigo-400");
}
function hideLoading(){
  document.getElementById('summarizeBtn').disabled=false;
  document.getElementById('summarizeBtn').innerHTML='Summarize Video';
  showStatus("");
}
function formatSummary(text){
  return text.split("\n").map(l=>l.trim()).filter(l=>l.startsWith("* ")).map(l=>
    `<p class="flex items-start"><span class="text-indigo-400 mr-2 font-bold text-lg">â€¢</span><span class="text-gray-300">${l.slice(2)}</span></p>`
  ).join('');
}

// âœ… Updated validation (accepts web, app, and short URLs)
function isValidYouTubeUrl(url){
  return /^(https?:\/\/)?(www\.|m\.)?(youtube\.com|youtu\.be)\/.+/.test(url);
}

async function summarizeVideo(){
  const url=document.getElementById('youtubeLink').value.trim();
  if(!isValidYouTubeUrl(url)){showStatus("Enter a valid YouTube URL",'text-red-400');return;}
  showLoading();
  try{
    const res=await fetch('/summarize',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({youtube_link:url})});
    const data=await res.json();
    hideLoading();
    if(res.ok){
      document.getElementById('summaryContent').innerHTML=formatSummary(data.summary);
      document.getElementById('resultsArea').classList.remove('hidden');
    } else { showStatus(data.error,'text-red-400'); }
  } catch(e){hideLoading(); showStatus("Error contacting server.",'text-red-400'); console.error(e);}
}

document.addEventListener('DOMContentLoaded',()=>{
  showStatus("Enter a public YouTube link and press 'Summarize'.");
  document.getElementById('youtubeLink').addEventListener('keydown',e=>{
    if(e.key==='Enter'){e.preventDefault();summarizeVideo();}
  });
});
</script>

</body>
</html>
